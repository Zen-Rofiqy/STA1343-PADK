> **Kota** yang memilikipengaruh yang **signifikan**
#                      -=( Install & Load Package Function )=-
install_load <- function (package1, ...)  {
# convert arguments to vector
packages <- c(package1, ...)
# start loop to determine if each package is installed
for(package in packages){
# if package is installed locally, load
if(package %in% rownames(installed.packages()))
do.call('library', list(package))
# if package is not installed locally, download, then load
else {
install.packages(package)
do.call("library", list(package))
}
}
}
#Path Function
path <- function(){
gsub  ( "\\\\",  "/",  readClipboard ()  )
}
#Copy path, Panggil function di console
#Copy r path, paste ke var yang diinginkan
install_load('dplyr', 'DT', 'tidyr', 'stringr')
# Mengubah Tabel Kontingensi ke dalam Data Frame R
data <- data.frame(
City = rep(c("Beijing", "Shanghai", "Shenyang", "Nanjing", "Harbin", "Zehgzhou", "Taiyuan", "Nanchang"), each = 2),
Smoking = rep(c("Yes", "No"), times = 8),
LungCancer_Yes = c(126, 35, 908, 497, 913, 336, 235, 58, 402, 121, 182, 72, 60, 11, 104, 21),
LungCancer_No = c(100, 61, 688, 807, 747, 598, 172, 121, 308, 215, 156, 98, 99, 43, 89, 36)
)
datatable(data)
data2 <- data %>%
pivot_longer(cols = c("LungCancer_Yes", "LungCancer_No"),
names_to = "LungCancer", values_to = "Count") %>%
mutate(LungCancer = ifelse(str_detect(LungCancer, "Yes"), "Yes", "No")) %>%
uncount(weights = Count) %>%
select(City, Smoking, LungCancer) %>%
mutate(
City = as.factor(City),
Smoking = as.factor(Smoking),
LungCancer = as.factor(LungCancer)
)
datatable(data2)
str(data2)
data_restored <- data2 %>%
group_by(City, Smoking, LungCancer, .drop = TRUE) %>%
summarize(Count = n(), .groups = 'drop') %>%
pivot_wider(names_from = LungCancer, values_from = Count) %>%
ungroup()
datatable(data_restored)
model <- glm(LungCancer ~ Smoking + City, data = data2, family = binomial)
summary(model)
summary_model <- summary(model)
rasio.odds <- exp(coef(model)) %>% round(.,3)
p.value <- summary(model)$coefficients[, "Pr(>|z|)"] %>%
sprintf("%.2e", .)
datatable(data.frame(rasio.odds[1:2], p.value[1:2]))
rasio.odds[1:2]
## **No 4.**
> **Kota** yang memilikipengaruh yang **signifikan**
## **No 4.**
> **Kota** yang memilikipengaruh yang **signifikan**
model2 <- glm(LungCancer ~ City, data = data2, family = binomial)
